the_map = [
    "...#........................................#........#.................#............#.#.......................#...............#..#",
    "...#........#.....#..................................................................................#......#..#..................",
    ".................#.......................#.#........#......#...........................................#...#..........#...........",
    "..................#..................#...#.....................................#........#.........................................",
    "...#.....#.......#..............#.#....##.............#....##......................................#...................#..........",
    "...#..........................................................................................................................#...",
    "..#..#.............#.....#...............#.......#..............................................#....#............................",
    "......................#..#...............#...................#....#..........................#...#............#...#....##.........",
    "..#.#.........#................#............#............#.#.......#................#....#..#.....................................",
    ".......................................................................#.....................................#...........#........",
    "...........#.....................................................................#.................................#......#.......",
    "...#.........#....................................................#..............#.............#..........#.......................",
    ".................................................................................................#................................",
    "..................................#.#.#...#.......#.............#.......................#..#.......................#.#............",
    ".......................#.........................................#..........#...#.....#....................................#......",
    ".......#.......#.#...........#......................#.....#..#...#.#...............#.............................#...#............",
    "............##...#......#.........#......#............................................................#.........#..............#..",
    "..#........................................#........##..#...............................................................#.........",
    "...........#..............##................................................................................#.....................",
    "..#................................................................................#..............#...............................",
    "...................................##..............#..........................#.......#..#...............#........#...............",
    "....#............#.........................#................................................................#........#............",
    "............#.....................................................................#.............................................#.",
    "............#..........#.......#...........#.#......#..............#.........#.......................................#......#.....",
    "..#...............................................#..................................#.............................#.............#",
    ".........................................................................#........#................#......#.......#....#........#.",
    ".......................................................................#.....##.................................................#.",
    "..............#.............#...........................#...#..#....................................................#.............",
    ".......#..........................#.......................###..................................#.....................#..#.........",
    "................#.................#.............#......................................................................#........#.",
    ".#.....#................#......................................................................#................#.................",
    "................................#........................#........#..#........................#...................................",
    "..............................................................................................#.....................#.........#...",
    "..................#.................#.........................#.....#................#............................................",
    "......#...................#...#...................#..................#...........................#......###...................#...",
    ".............................##.....#..............#..............................................................#....#..........",
    "......#..................#....................................................###....................#..............#.............",
    "............#...#..................#........#.............#..............................#.........#..........................#...",
    "....#...............................#......#......#...............#.#......#............#...................................#.....",
    ".......#...................................#.#.#.........................................................#..................#.....",
    ".....................#.......#.#......#.#.....................#...................................................................",
    "......#.....#............................................................................#............#.......#..#................",
    "..........#.#......#...................................#....#.#............##.....................................................",
    "...............#........................#..................................#...........#...................................#......",
    ".#....................................................#.......................................................................#...",
    "......#.........................................#...#.........................................#........#..........................",
    ".........................................#..........#.............................................................................",
    "...................#.....................................#.....................#..#............#....#........................##...",
    ".................................#.........#.............#.............................#...........................#...#..........",
    "..#................................................................#.....#....#.................................#.................",
    "........#................#............#.#..........................................#..............................................",
    "..#...........##.....................#..#..........................#...#...#....#.................................................",
    "................................................................................#.................................................",
    "............#...........#.........#....#.........................................................................#................",
    ".............................#...........................................#...............##...................................#...",
    "......................#..............#...#........................#........................................#......................",
    "............#..............#...#.....#.....#..........#...........................#........#...............#......................",
    "..................#............................#....#................................................................#............",
    "..#........................#.............................#......#...............#....#...........#................................",
    ".................................................#................................................#..................#........#...",
    ".#......#.........................................................#...........#...#.......................#.......................",
    "..........................................#.......##........#................................................#..##............##..",
    "..............#...#....................................................................#........#...........................#.....",
    "................#....................................................................#........................................###.",
    "....#............................................#........................#.................#........#.....#...#.....#.#....#.....",
    "...##..........#..................................................................................................................",
    "#....#.........#....................#.#.........................#..........##.......#....#..#....................#................",
    "........#.........#..........#.................#..................#................................#.......#................#...#.",
    ".#..........................................#..#..#......#................................#.#.#..#................................",
    "....#.......#.........#............................................................#....#.........................................",
    ".....................................................................#...#......................#.................................",
    "............#.....#.....#..........#...............................................................................#..............",
    ".........................#...#.#.......#....................................................................#.................#...",
    "......................................................#.#..........................#...#................#.........................",
    ".....#.........#.........#..............................................................#...................#.#......#............",
    ".......................................#......#.......................#.................................................#.....#...",
    ".....#....#.......................................................................................................................",
    "#..........#....#....................................#.............#...............#...................#..........#...............",
    "..#....................................##.....................................#...............................#...................",
    "....#..................................#........................#.................................................................",
    "....#................................................................................................#...................#........",
    "....#................................................................................#............................................",
    "..........#.....#...................#.......................#......#..............................................................",
    "#...................#..........#............................................................#............#..............#.........",
    "...#...#....#................................#............................#.##.....................................#..............",
    "..........#.........#.....#...........#............................#...............#.#....#................#....................##",
    ".....#...................................................#........................................................................",
    "............##....................................#..................#.#..#.....................#.........#....##......#...#......",
    "...........#.......#....................#.......................#..#.................#.......#.........#..........................",
    "#.....................#..#..............................................................................................#.........",
    "....#....#..............#............##....................................................^.................#..............#.....",
    ".........#......................................................#..............#............#...#......#....#.....................",
    ".......##...................#...........#.........#.......................................#..........................#............",
    ".#........#.#........................#...........#............#..#........#........#.............#................................",
    "..................##........##.................................................................................#................#.",
    "...#...................#.....#...........#.........#..#............#..................................#.....#.....................",
    ".................#.........#..........#............#......#.........................#.............#.......#......................#",
    ".................................................................#...............#.....#.#....#...................................",
    "..........................#...........................................................................................#..#........",
    "..............#.................................................................................##......................#.........",
    "....#...#....................#...............................................#................#............#......................",
    "........................................................................#........#................................................",
    "....#.....#......................#.......#............#......................................#..................................#.",
    "................#................................#.#.............#.#.........#..............................................#.....",
    "..............#..................#...#...........................................................................#................",
    "...#..........#....................................................#...............................#...........#.......#..........",
    "...................................#....................#..#.#........#..#.......................#...#.....#......................",
    ".......#.....#.#.......#....#............#...............#..........#.................#........#.#................................",
    ".....#....#.........#........#.......#............................................................................................",
    "..#........#......#............................................................#..........#...............................#.......",
    "..#..#...................................#....................#...#.#................#......................#.....................",
    "....................................#......#.....................#...........#.....................#........#.....................",
    ".#..................#.........................................................................................................#...",
    "..............#...........#.#....#..#......#..#.#...#.#.........................................................................#.",
    "...#............##.......................................................#.......................#..#.............................",
    "......#........#..........#..#.#........#.....................#...................................................................",
    "...#...........#.........................................#............#.............#....#.....................................#..",
    "...........#.....................#......................................................................................#.........",
    ".......#..............#...............#............#..........................#............................#........##............",
    ".............#..........#..............................................#................#..............................#..........",
    "...............#..............................#.................#.....#................#....#.....................................",
    "............#.................#..........#........#............#..#......#.......................#....#...#.#...#.#...............",
    ".......#.#...................................##..............#.....#.....................#.................................##.....",
    "..#..#...#...#....#.............#..#.....................................................................................#........",
    "......#......................#...#...#..........#......................................#.................#....#.................#.",
    ".......#...........#...........#...................#..............................#.......................................#.......",
    "......#.......................................#...............................................#.........#........#....#.........##",
    "......#.................................................................#...#............#..........#.............................",
    ".....................................#..........#.........#.....#.............#...........#.......................................",
    ".#.....................................#......................#.....#..#..........................................................",
]

i = -1
for l in the_map:
    i += 1
    try:
        j = l.index("^")
        break
    except Exception:
        pass

Direc = {0: (-1, 0), 90: (0, 1), 180: (1, 0), 270: (0, -1)}
the_map = [[i for i in l] for l in the_map]


def next_case(dir):
    a, b = Direc[dir]
    if the_map[i + a][j + b] == ".":
        the_map[i + a][j + b] = "X"
        return i + a, j + b, 1, dir
    elif the_map[i + a][j + b] == "X":
        return i + a, j + b, 0, dir
    else:
        dir = (dir + 90) % 360
        return next_case(dir)


n = 1
the_map[i][j] = "X"
ok = True
dir = 0
while ok:
    try:
        i, j, res, dir = next_case(dir)
        if i<0 or j<0:
            a = [][4]
        n += res
    except Exception:
        ok = False
        break
print(the_map, n)

