the_map = [
    "...#........................................#........#.................#............#.#.......................#...............#..#",
    "...#........#.....#..................................................................................#......#..#..................",
    ".................#.......................#.#........#......#...........................................#...#..........#...........",
    "..................#..................#...#.....................................#........#.........................................",
    "...#.....#.......#..............#.#....##.............#....##......................................#...................#..........",
    "...#..........................................................................................................................#...",
    "..#..#.............#.....#...............#.......#..............................................#....#............................",
    "......................#..#...............#...................#....#..........................#...#............#...#....##.........",
    "..#.#.........#................#............#............#.#.......#................#....#..#.....................................",
    ".......................................................................#.....................................#...........#........",
    "...........#.....................................................................#.................................#......#.......",
    "...#.........#....................................................#..............#.............#..........#.......................",
    ".................................................................................................#................................",
    "..................................#.#.#...#.......#.............#.......................#..#.......................#.#............",
    ".......................#.........................................#..........#...#.....#....................................#......",
    ".......#.......#.#...........#......................#.....#..#...#.#...............#.............................#...#............",
    "............##...#......#.........#......#............................................................#.........#..............#..",
    "..#........................................#........##..#...............................................................#.........",
    "...........#..............##................................................................................#.....................",
    "..#................................................................................#..............#...............................",
    "...................................##..............#..........................#.......#..#...............#........#...............",
    "....#............#.........................#................................................................#........#............",
    "............#.....................................................................#.............................................#.",
    "............#..........#.......#...........#.#......#..............#.........#.......................................#......#.....",
    "..#...............................................#..................................#.............................#.............#",
    ".........................................................................#........#................#......#.......#....#........#.",
    ".......................................................................#.....##.................................................#.",
    "..............#.............#...........................#...#..#....................................................#.............",
    ".......#..........................#.......................###..................................#.....................#..#.........",
    "................#.................#.............#......................................................................#........#.",
    ".#.....#................#......................................................................#................#.................",
    "................................#........................#........#..#........................#...................................",
    "..............................................................................................#.....................#.........#...",
    "..................#.................#.........................#.....#................#............................................",
    "......#...................#...#...................#..................#...........................#......###...................#...",
    ".............................##.....#..............#..............................................................#....#..........",
    "......#..................#....................................................###....................#..............#.............",
    "............#...#..................#........#.............#..............................#.........#..........................#...",
    "....#...............................#......#......#...............#.#......#............#...................................#.....",
    ".......#...................................#.#.#.........................................................#..................#.....",
    ".....................#.......#.#......#.#.....................#...................................................................",
    "......#.....#............................................................................#............#.......#..#................",
    "..........#.#......#...................................#....#.#............##.....................................................",
    "...............#........................#..................................#...........#...................................#......",
    ".#....................................................#.......................................................................#...",
    "......#.........................................#...#.........................................#........#..........................",
    ".........................................#..........#.............................................................................",
    "...................#.....................................#.....................#..#............#....#........................##...",
    ".................................#.........#.............#.............................#...........................#...#..........",
    "..#................................................................#.....#....#.................................#.................",
    "........#................#............#.#..........................................#..............................................",
    "..#...........##.....................#..#..........................#...#...#....#.................................................",
    "................................................................................#.................................................",
    "............#...........#.........#....#.........................................................................#................",
    ".............................#...........................................#...............##...................................#...",
    "......................#..............#...#........................#........................................#......................",
    "............#..............#...#.....#.....#..........#...........................#........#...............#......................",
    "..................#............................#....#................................................................#............",
    "..#........................#.............................#......#...............#....#...........#................................",
    ".................................................#................................................#..................#........#...",
    ".#......#.........................................................#...........#...#.......................#.......................",
    "..........................................#.......##........#................................................#..##............##..",
    "..............#...#....................................................................#........#...........................#.....",
    "................#....................................................................#........................................###.",
    "....#............................................#........................#.................#........#.....#...#.....#.#....#.....",
    "...##..........#..................................................................................................................",
    "#....#.........#....................#.#.........................#..........##.......#....#..#....................#................",
    "........#.........#..........#.................#..................#................................#.......#................#...#.",
    ".#..........................................#..#..#......#................................#.#.#..#................................",
    "....#.......#.........#............................................................#....#.........................................",
    ".....................................................................#...#......................#.................................",
    "............#.....#.....#..........#...............................................................................#..............",
    ".........................#...#.#.......#....................................................................#.................#...",
    "......................................................#.#..........................#...#................#.........................",
    ".....#.........#.........#..............................................................#...................#.#......#............",
    ".......................................#......#.......................#.................................................#.....#...",
    ".....#....#.......................................................................................................................",
    "#..........#....#....................................#.............#...............#...................#..........#...............",
    "..#....................................##.....................................#...............................#...................",
    "....#..................................#........................#.................................................................",
    "....#................................................................................................#...................#........",
    "....#................................................................................#............................................",
    "..........#.....#...................#.......................#......#..............................................................",
    "#...................#..........#............................................................#............#..............#.........",
    "...#...#....#................................#............................#.##.....................................#..............",
    "..........#.........#.....#...........#............................#...............#.#....#................#....................##",
    ".....#...................................................#........................................................................",
    "............##....................................#..................#.#..#.....................#.........#....##......#...#......",
    "...........#.......#....................#.......................#..#.................#.......#.........#..........................",
    "#.....................#..#..............................................................................................#.........",
    "....#....#..............#............##....................................................^.................#..............#.....",
    ".........#......................................................#..............#............#...#......#....#.....................",
    ".......##...................#...........#.........#.......................................#..........................#............",
    ".#........#.#........................#...........#............#..#........#........#.............#................................",
    "..................##........##.................................................................................#................#.",
    "...#...................#.....#...........#.........#..#............#..................................#.....#.....................",
    ".................#.........#..........#............#......#.........................#.............#.......#......................#",
    ".................................................................#...............#.....#.#....#...................................",
    "..........................#...........................................................................................#..#........",
    "..............#.................................................................................##......................#.........",
    "....#...#....................#...............................................#................#............#......................",
    "........................................................................#........#................................................",
    "....#.....#......................#.......#............#......................................#..................................#.",
    "................#................................#.#.............#.#.........#..............................................#.....",
    "..............#..................#...#...........................................................................#................",
    "...#..........#....................................................#...............................#...........#.......#..........",
    "...................................#....................#..#.#........#..#.......................#...#.....#......................",
    ".......#.....#.#.......#....#............#...............#..........#.................#........#.#................................",
    ".....#....#.........#........#.......#............................................................................................",
    "..#........#......#............................................................#..........#...............................#.......",
    "..#..#...................................#....................#...#.#................#......................#.....................",
    "....................................#......#.....................#...........#.....................#........#.....................",
    ".#..................#.........................................................................................................#...",
    "..............#...........#.#....#..#......#..#.#...#.#.........................................................................#.",
    "...#............##.......................................................#.......................#..#.............................",
    "......#........#..........#..#.#........#.....................#...................................................................",
    "...#...........#.........................................#............#.............#....#.....................................#..",
    "...........#.....................#......................................................................................#.........",
    ".......#..............#...............#............#..........................#............................#........##............",
    ".............#..........#..............................................#................#..............................#..........",
    "...............#..............................#.................#.....#................#....#.....................................",
    "............#.................#..........#........#............#..#......#.......................#....#...#.#...#.#...............",
    ".......#.#...................................##..............#.....#.....................#.................................##.....",
    "..#..#...#...#....#.............#..#.....................................................................................#........",
    "......#......................#...#...#..........#......................................#.................#....#.................#.",
    ".......#...........#...........#...................#..............................#.......................................#.......",
    "......#.......................................#...............................................#.........#........#....#.........##",
    "......#.................................................................#...#............#..........#.............................",
    ".....................................#..........#.........#.....#.............#...........#.......................................",
    ".#.....................................#......................#.....#..#..........................................................",
]

# the_map = [
# "....#.....",
# ".........#",
# "..........",
# "..#.......",
# ".......#..",
# "..........",
# ".#..^.....",
# "........#.",
# "#.........",
# "......#...",
# ]

i = -1
for l in the_map:
    i += 1
    try:
        j = l.index("^")
        break
    except Exception:
        pass

Direc = {0: (-1, 0), 90: (0, 1), 180: (1, 0), 270: (0, -1)}
the_map = [[i for i in l] for l in the_map]
maps = [[i.copy() for i in the_map] for _ in range(5516)]
demi = []

def next_case(dir, n):
    a, b = Direc[dir]
    if the_map[i + a][j + b] == ".":
        maps[n][i + a][j + b] = "#"
        the_map[i + a][j + b] = "X"
        return i + a, j + b, 1, dir
    elif the_map[i + a][j + b] == "X":
        return i + a, j + b, 0, dir
    else:
        dir = (dir + 90) % 360
        demi.append((i, j))
        return next_case(dir, n)


def next_case2(dir, allowed=True):
    a, b = Direc[dir]
    if M[i + a][j + b] == ".":
        M[i + a][j + b] = "X"
        return i + a, j + b, 0, dir
    elif M[i + a][j + b] == "X":
        return i + a, j + b, 0, dir
    else:
        if (i + a, j + b, dir) in to_check:
            if allowed or (i, j) in demi:
                return -10, -1, 1, dir
            else:
                print(i, j, dir)
        else:
            to_check.append((i + a, j + b, dir))
            dir = (dir + 90) % 360
            return next_case2(dir, False)


n = 1
i1, j1 = i, j
the_map[i][j] = "X"
ok = True
dir = 0
while ok:
    try:
        i, j, res, dir = next_case(dir, n)
        if i < 0 or j < 0:
            a = [][4]
        n += res
    except Exception:
        ok = False
        break

n = 0
for k in range(0, len(maps)):
    M = maps[k]
    i, j = i1, j1
    M[i][j] = "X"
    to_check = []
    ok = True
    dir = 0
    while ok:
        try:
            i, j, res, dir = next_case2(dir)
            if i < -5:
                n += res
            if i < 0 or j < 0:
                a = [][4]
        except Exception:
            ok = False
print(n)
